<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>养殖管理系统 - 设置中心</title>
    <script src="./assets/3.4.17.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2E7D32',
                        secondary: '#1976D2',
                        success: '#2E7D32',
                        warning: '#F57F17',
                        danger: '#D32F2F',
                        surface: '#f8fafc',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans SC', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <style>
        body { 
            background-color: #f1f5f9; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            min-h-screen; 
            font-family: 'Noto Sans SC', sans-serif; 
        }
        
        .iphone-canvas {
            width: 375px;
            height: 812px;
            background: #ffffff;
            position: relative;
            overflow: hidden;
            border-radius: 40px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.2);
            border: 8px solid #1e293b;
        }
        
        .hide-scroll::-webkit-scrollbar { display: none; }
        .glass-header { backdrop-filter: blur(10px); background: rgba(255,255,255,0.8); }
        .nav-item.active { 
            color: #2E7D32; 
        }
        
        /* 提示框样式 */
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            z-index: 9999;
            display: none;
        }
        
        .success-toast {
            position: fixed;
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(46, 125, 50, 0.9);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            z-index: 9999;
            display: none;
            animation: fadeInOut 2s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; bottom: 15%; }
            20% { opacity: 1; bottom: 20%; }
            80% { opacity: 1; bottom: 20%; }
            100% { opacity: 0; bottom: 15%; }
        }
        
        /* 模态框样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 340px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 1.5rem;
        }
        
        /* 日志列表样式 */
        .log-item {
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .log-item:hover {
            border-left-color: #2E7D32;
            background-color: rgba(46, 125, 50, 0.05);
        }
        
        /* 管理员标签 */
        .admin-tag {
            background-color: rgba(211, 47, 47, 0.1);
            color: #D32F2F;
            padding: 0.1rem 0.5rem;
            border-radius: 999px;
            font-size: 10px;
            font-weight: 500;
        }
        
        /* 状态标签 */
        .status-active {
            background-color: rgba(46, 125, 50, 0.1);
            color: #2E7D32;
        }
        
        .status-disabled {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="iphone-canvas flex flex-col">
        <!-- 顶部状态栏 -->
        <header class="glass-header sticky top-0 z-10 px-6 pt-12 pb-4 flex justify-between items-center border-b border-slate-50">
            <button class="text-slate-800" onclick="goBackToHome()">
                <i data-lucide="arrow-left" class="w-5 h-5"></i>
            </button>
            <h1 class="text-lg font-bold text-slate-800">设置中心</h1>
            <div class="w-5 h-5"></div> <!-- 占位符 -->
        </header>

        <!-- 主内容区 -->
        <main class="flex-1 overflow-y-auto hide-scroll px-6 py-4">
            <!-- 当前用户信息 -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-6 flex items-center gap-4">
                <div class="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center">
                    <i data-lucide="user" class="w-6 h-6 text-primary"></i>
                </div>
                <div>
                    <h2 class="font-bold text-slate-800">jingxuehui</h2>
                    <p class="text-sm text-slate-500">超级管理员 | 最后登录：2026-02-27 09:15</p>
                </div>
            </div>
            
            <!-- 设置功能列表 -->
            <div class="space-y-4">
                <!-- 密码修改 -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center cursor-pointer" onclick="toggleSection('passwordSection')">
                        <div class="flex items-center gap-3">
                            <i data-lucide="lock" class="w-5 h-5 text-primary"></i>
                            <span class="font-medium">密码修改</span>
                        </div>
                        <i data-lucide="chevron-down" class="w-4 h-4 text-slate-400 transition-transform" id="passwordIcon"></i>
                    </div>
                    <div id="passwordSection" class="p-4 hidden">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-slate-600 mb-1">原密码</label>
                                <input type="password" id="oldPassword" class="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                            </div>
                            <div>
                                <label class="block text-sm text-slate-600 mb-1">新密码</label>
                                <input type="password" id="newPassword" class="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                                <p class="text-xs text-slate-500 mt-1">密码长度不少于8位，包含字母和数字</p>
                            </div>
                            <div>
                                <label class="block text-sm text-slate-600 mb-1">确认新密码</label>
                                <input type="password" id="confirmPassword" class="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                            </div>
                            <button class="w-full py-2.5 bg-primary text-white rounded-lg text-sm hover:bg-primary/90 transition-colors" onclick="changePassword()">
                                提交修改
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 数据备份与恢复 -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center cursor-pointer" onclick="toggleSection('backupSection')">
                        <div class="flex items-center gap-3">
                            <i data-lucide="database" class="w-5 h-5 text-primary"></i>
                            <span class="font-medium">数据备份与恢复</span>
							<span class="admin-tag ml-2">管理员</span>
                        </div>
                        <i data-lucide="chevron-down" class="w-4 h-4 text-slate-400 transition-transform" id="backupIcon"></i>
                    </div>
                    <div id="backupSection" class="p-4 hidden">
                        <div class="space-y-6">
                            <!-- 数据备份 -->
                            <div>
                                <h3 class="text-sm font-semibold text-slate-800 mb-3">数据备份</h3>
                                <div class="bg-slate-50 rounded-lg p-3 mb-3">
                                    <div class="flex justify-between text-sm mb-1">
                                        <span class="text-slate-500">最近备份时间：</span>
                                        <span class="font-medium" id="lastBackupTime">2026-02-25 18:30</span>
                                    </div>
                                    <p class="text-xs text-slate-500">系统自动每日23:00备份，也可手动备份</p>
                                </div>
                                <button class="w-full py-2 bg-secondary text-white rounded-lg text-sm hover:bg-secondary/90 transition-colors" onclick="manualBackup()">
                                    <i data-lucide="save" class="w-4 h-4 mr-1 inline"></i>手动备份
                                </button>
                            </div>
                            
                            <!-- 数据恢复 -->
                            <div>
                                <h3 class="text-sm font-semibold text-slate-800 mb-3">数据恢复</h3>
                                <div class="space-y-3">
                                    <div class="relative">
                                        <select id="backupSelect" class="appearance-none w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                                            <option value="20260225">2026-02-25 18:30（手动备份）</option>
                                            <option value="20260224">2026-02-24 23:00（自动备份）</option>
                                            <option value="20260223">2026-02-23 23:00（自动备份）</option>
                                            <option value="20260222">2026-02-22 23:00（自动备份）</option>
                                            <option value="20260221">2026-02-21 23:00（自动备份）</option>
                                        </select>
                                        <i data-lucide="chevron-down" class="w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"></i>
                                    </div>
                                    <button class="w-full py-2 bg-warning text-white rounded-lg text-sm hover:bg-warning/90 transition-colors" onclick="showRestoreConfirm()">
                                        <i data-lucide="rotate-ccw" class="w-4 h-4 mr-1 inline"></i>恢复选中备份
                                    </button>
                                    <p class="text-xs text-danger">⚠️ 数据恢复将覆盖当前所有数据，请谨慎操作！</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 操作日志 -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center cursor-pointer" onclick="toggleSection('logSection')">
                        <div class="flex items-center gap-3">
                            <i data-lucide="file-text" class="w-5 h-5 text-primary"></i>
                            <span class="font-medium">操作日志</span>
                        </div>
                        <i data-lucide="chevron-down" class="w-4 h-4 text-slate-400 transition-transform" id="logIcon"></i>
                    </div>
                    <div id="logSection" class="p-4 hidden">
                        <!-- 日志筛选 -->
                        <div class="mb-4">
                            <div class="flex gap-2 mb-3">
                                <input type="text" id="logSearch" placeholder="搜索操作内容..." class="flex-1 px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                                <button class="px-3 py-2 bg-primary text-white rounded-lg text-sm" onclick="searchLogs()">
                                    <i data-lucide="search" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <div class="flex gap-2 overflow-x-auto hide-scroll pb-2">
                                <button class="whitespace-nowrap px-3 py-1.5 bg-primary text-white rounded-lg text-xs">全部</button>
                                <button class="whitespace-nowrap px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg text-xs hover:bg-slate-200">销售管理</button>
                                <button class="whitespace-nowrap px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg text-xs hover:bg-slate-200">收支管理</button>
                                <button class="whitespace-nowrap px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg text-xs hover:bg-slate-200">报表导出</button>
                                <button class="whitespace-nowrap px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg text-xs hover:bg-slate-200">系统设置</button>
                            </div>
                        </div>
                        
                        <!-- 日志列表 -->
                        <div class="space-y-3 max-h-64 overflow-y-auto hide-scroll pr-1">
                            <!-- 日志项1 -->
                            <div class="log-item p-3 bg-slate-50 rounded-lg">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="font-medium text-sm">报表导出</span>
                                    <span class="text-xs text-slate-500">2026-02-27 10:15</span>
                                </div>
                                <div class="text-sm text-slate-700 mb-1">导出了2026年02月销售月报</div>
                                <div class="text-xs text-slate-500">操作人：jingxuehui（超级管理员）</div>
                            </div>
                            
                            <!-- 日志项2 -->
                            <div class="log-item p-3 bg-slate-50 rounded-lg">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="font-medium text-sm">收支管理</span>
                                    <span class="text-xs text-slate-500">2026-02-27 09:45</span>
                                </div>
                                <div class="text-sm text-slate-700 mb-1">新增了一笔饲料采购支出，金额¥12,500</div>
                                <div class="text-xs text-slate-500">操作人：jingxuehui（超级管理员）</div>
                            </div>
                            
                            <!-- 日志项3 -->
                            <div class="log-item p-3 bg-slate-50 rounded-lg">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="font-medium text-sm">系统设置</span>
                                    <span class="text-xs text-slate-500">2026-02-26 16:30</span>
                                </div>
                                <div class="text-sm text-slate-700 mb-1">执行了手动数据备份</div>
                                <div class="text-xs text-slate-500">操作人：jingxuehui（超级管理员）</div>
                            </div>
                            
                            <!-- 日志项4 -->
                            <div class="log-item p-3 bg-slate-50 rounded-lg">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="font-medium text-sm">销售管理</span>
                                    <span class="text-xs text-slate-500">2026-02-26 14:20</span>
                                </div>
                                <div class="text-sm text-slate-700 mb-1">新增了一笔鸡蛋销售记录，金额¥8,600</div>
                                <div class="text-xs text-slate-500">操作人：jingxuehui（超级管理员）</div>
                            </div>
                            
                            <!-- 日志项5 -->
                            <div class="log-item p-3 bg-slate-50 rounded-lg">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="font-medium text-sm">账号管理</span>
                                    <span class="text-xs text-slate-500">2026-02-25 11:05</span>
                                </div>
                                <div class="text-sm text-slate-700 mb-1">新增了操作员账号：zhangsan</div>
                                <div class="text-xs text-slate-500">操作人：jingxuehui（超级管理员）</div>
                            </div>
                        </div>
                        
                        <button class="w-full mt-4 py-2 border border-slate-200 rounded-lg text-sm text-slate-600 hover:bg-slate-50 transition-colors" onclick="viewAllLogs()">
                            查看全部日志
                        </button>
                    </div>
                </div>
                
                <!-- 账号管理（仅超级管理员可见） -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center cursor-pointer" onclick="toggleSection('accountSection')">
                        <div class="flex items-center gap-3">
                            <i data-lucide="users" class="w-5 h-5 text-primary"></i>
                            <div class="flex items-center">
                                <span class="font-medium">账号管理</span>
                                <span class="admin-tag ml-2">管理员</span>
                            </div>
                        </div>
                        <i data-lucide="chevron-down" class="w-4 h-4 text-slate-400 transition-transform" id="accountIcon"></i>
                    </div>
                    <div id="accountSection" class="p-4 hidden">
                        <!-- 新增账号按钮 -->
                        <button class="w-full py-2 bg-primary text-white rounded-lg text-sm hover:bg-primary/90 transition-colors mb-4" onclick="showAddAccountModal()">
                            <i data-lucide="plus" class="w-4 h-4 mr-1 inline"></i>新增账号
                        </button>
                        
                        <!-- 账号列表 -->
                        <div class="space-y-3 max-h-64 overflow-y-auto hide-scroll pr-1">
                            <!-- 超级管理员账号 -->
                            <div class="p-3 bg-slate-50 rounded-lg flex justify-between items-center">
                                <div>
                                    <div class="font-medium text-sm">jingxuehui</div>
                                    <div class="text-xs text-slate-500">超级管理员 | 已启用</div>
                                </div>
                                <div class="flex gap-2">
                                    <button class="px-2 py-1 bg-slate-200 text-slate-700 rounded text-xs disabled:opacity-50" disabled>
                                        <i data-lucide="lock" class="w-3 h-3 mr-1 inline"></i>禁用
                                    </button>
                                    <button class="px-2 py-1 bg-secondary text-white rounded text-xs" onclick="resetPassword('jingxuehui')">
                                        <i data-lucide="refresh-cw" class="w-3 h-3 mr-1 inline"></i>重置密码
                                    </button>
                                </div>
                            </div>
                            
                            <!-- 操作员账号1 -->
                            <div class="p-3 bg-slate-50 rounded-lg flex justify-between items-center">
                                <div>
                                    <div class="font-medium text-sm">zhangsan</div>
                                    <div class="text-xs text-slate-500">操作员 | 已启用</div>
                                </div>
                                <div class="flex gap-2">
                                    <button class="px-2 py-1 bg-danger text-white rounded text-xs" onclick="toggleAccountStatus('zhangsan', 'disable')">
                                        <i data-lucide="lock" class="w-3 h-3 mr-1 inline"></i>禁用
                                    </button>
                                    <button class="px-2 py-1 bg-secondary text-white rounded text-xs" onclick="resetPassword('zhangsan')">
                                        <i data-lucide="refresh-cw" class="w-3 h-3 mr-1 inline"></i>重置密码
                                    </button>
                                </div>
                            </div>
                            
                            <!-- 操作员账号2 -->
                            <div class="p-3 bg-slate-50 rounded-lg flex justify-between items-center">
                                <div>
                                    <div class="font-medium text-sm">lisi</div>
                                    <div class="text-xs text-slate-500">操作员 | 已禁用</div>
                                </div>
                                <div class="flex gap-2">
                                    <button class="px-2 py-1 bg-success text-white rounded text-xs" onclick="toggleAccountStatus('lisi', 'enable')">
                                        <i data-lucide="unlock" class="w-3 h-3 mr-1 inline"></i>启用
                                    </button>
                                    <button class="px-2 py-1 bg-secondary text-white rounded text-xs" onclick="resetPassword('lisi')">
                                        <i data-lucide="refresh-cw" class="w-3 h-3 mr-1 inline"></i>重置密码
                                    </button>
                                </div>
                            </div>
                            
                            <!-- 财务账号 -->
                            <div class="p-3 bg-slate-50 rounded-lg flex justify-between items-center">
                                <div>
                                    <div class="font-medium text-sm">wangwu</div>
                                    <div class="text-xs text-slate-500">财务 | 已启用</div>
                                </div>
                                <div class="flex gap-2">
                                    <button class="px-2 py-1 bg-danger text-white rounded text-xs" onclick="toggleAccountStatus('wangwu', 'disable')">
                                        <i data-lucide="lock" class="w-3 h-3 mr-1 inline"></i>禁用
                                    </button>
                                    <button class="px-2 py-1 bg-secondary text-white rounded text-xs" onclick="resetPassword('wangwu')">
                                        <i data-lucide="refresh-cw" class="w-3 h-3 mr-1 inline"></i>重置密码
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 提示框 -->
        <div id="loadingToast" class="toast">
            <i data-lucide="loader-circle" class="w-6 h-6 animate-spin mr-2 inline"></i>
            处理中，请稍候
        </div>
        
        <div id="successToast" class="success-toast">
            <i data-lucide="check-circle" class="w-4 h-4 mr-2 inline"></i>
            <span id="successText">操作成功</span>
        </div>
        
        <!-- 数据恢复确认模态框 -->
        <div id="restoreModal" class="modal-overlay">
            <div class="modal-content">
                <h2 class="text-lg font-bold text-slate-800 mb-4">确认数据恢复</h2>
                <p class="text-sm text-slate-600 mb-4">
                    您确定要恢复到 <span id="restoreTime" class="font-medium text-danger">2026-02-25 18:30</span> 的备份数据吗？<br>
                    此操作将覆盖当前所有数据，且无法撤销！
                </p>
                <div class="flex gap-3">
                    <button class="flex-1 py-2 border border-slate-200 rounded-lg text-sm text-slate-600 hover:bg-slate-50 transition-colors" onclick="closeRestoreModal()">
                        取消
                    </button>
                    <button class="flex-1 py-2 bg-danger text-white rounded-lg text-sm hover:bg-danger/90 transition-colors" onclick="restoreData()">
                        确认恢复
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 新增账号模态框 -->
        <div id="addAccountModal" class="modal-overlay">
            <div class="modal-content">
                <h2 class="text-lg font-bold text-slate-800 mb-4">新增账号</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm text-slate-600 mb-1">账号名称</label>
                        <input type="text" id="accountName" placeholder="请输入账号名称" class="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                    </div>
                    <div>
                        <label class="block text-sm text-slate-600 mb-1">初始密码</label>
                        <input type="password" id="accountPassword" placeholder="请设置初始密码" class="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                    </div>
                    <div>
                        <label class="block text-sm text-slate-600 mb-1">账号类型</label>
                        <select id="accountType" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20">
                            <option value="operator">操作员</option>
                            <option value="finance">财务</option>
                            <option value="viewer">查看者</option>
                        </select>
                    </div>
                    <div class="flex gap-3">
                        <button class="flex-1 py-2 border border-slate-200 rounded-lg text-sm text-slate-600 hover:bg-slate-50 transition-colors" onclick="closeAddAccountModal()">
                            取消
                        </button>
                        <button class="flex-1 py-2 bg-primary text-white rounded-lg text-sm hover:bg-primary/90 transition-colors" onclick="addAccount()">
                            保存账号
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 重置密码确认模态框 -->
        <div id="resetPasswordModal" class="modal-overlay">
            <div class="modal-content">
                <h2 class="text-lg font-bold text-slate-800 mb-4">重置密码</h2>
                <p class="text-sm text-slate-600 mb-4">
                    您确定要重置 <span id="resetAccountName" class="font-medium text-primary">jingxuehui</span> 的密码吗？<br>
                    重置后密码将变为默认密码：<span class="font-medium">123456</span>
                </p>
                <div class="flex gap-3">
                    <button class="flex-1 py-2 border border-slate-200 rounded-lg text-sm text-slate-600 hover:bg-slate-50 transition-colors" onclick="closeResetPasswordModal()">
                        取消
                    </button>
                    <button class="flex-1 py-2 bg-primary text-white rounded-lg text-sm hover:bg-primary/90 transition-colors" onclick="confirmResetPassword()">
                        确认重置
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
        });

        // 返回首页
        function goBackToHome() {
            window.location.href = 'index.html';
        }

        // 切换功能区块显示/隐藏
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const icon = document.getElementById(sectionId.replace('Section', 'Icon'));
            
            if (section.classList.contains('hidden')) {
                section.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                section.classList.add('hidden');
                icon.style.transform = 'rotate(0)';
            }
        }

        // 修改密码
        function changePassword() {
            const oldPassword = document.getElementById('oldPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // 简单验证
            if (!oldPassword) {
                alert('请输入原密码');
                return;
            }
            
            if (!newPassword) {
                alert('请输入新密码');
                return;
            }
            
            if (newPassword.length < 8) {
                alert('新密码长度不能少于8位');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('两次输入的密码不一致');
                return;
            }
            
            // 显示加载提示
            document.getElementById('loadingToast').style.display = 'block';
            
            // 模拟请求延迟
            setTimeout(() => {
                document.getElementById('loadingToast').style.display = 'none';
                
                // 清空输入框
                document.getElementById('oldPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                
                // 显示成功提示
                document.getElementById('successText').textContent = '密码修改成功';
                document.getElementById('successToast').style.display = 'block';
                
                // 2秒后隐藏提示
                setTimeout(() => {
                    document.getElementById('successToast').style.display = 'none';
                }, 2000);
                
            }, 1000);
        }

        // 手动备份
        function manualBackup() {
            // 显示加载提示
            document.getElementById('loadingToast').style.display = 'block';
            
            // 模拟备份过程
            setTimeout(() => {
                document.getElementById('loadingToast').style.display = 'none';
                
                // 更新最后备份时间
                const now = new Date();
                const timeStr = now.getFullYear() + '-' + 
                               String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                               String(now.getDate()).padStart(2, '0') + ' ' + 
                               String(now.getHours()).padStart(2, '0') + ':' + 
                               String(now.getMinutes()).padStart(2, '0');
                
                document.getElementById('lastBackupTime').textContent = timeStr;
                
                // 更新备份下拉列表
                const backupSelect = document.getElementById('backupSelect');
                const newOption = document.createElement('option');
                newOption.value = now.getFullYear() + String(now.getMonth() + 1).padStart(2, '0') + String(now.getDate()).padStart(2, '0');
                newOption.textContent = timeStr + '（手动备份）';
                backupSelect.insertBefore(newOption, backupSelect.firstChild);
                
                // 显示成功提示
                document.getElementById('successText').textContent = '数据备份成功';
                document.getElementById('successToast').style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('successToast').style.display = 'none';
                }, 2000);
                
            }, 1500);
        }

        // 显示恢复确认框
        function showRestoreConfirm() {
            const backupSelect = document.getElementById('backupSelect');
            const selectedTime = backupSelect.options[backupSelect.selectedIndex].text.split('（')[0];
            document.getElementById('restoreTime').textContent = selectedTime;
            document.getElementById('restoreModal').style.display = 'flex';
        }

        // 关闭恢复确认框
        function closeRestoreModal() {
            document.getElementById('restoreModal').style.display = 'none';
        }

        // 恢复数据
        function restoreData() {
            // 显示加载提示
            document.getElementById('loadingToast').style.display = 'block';
            closeRestoreModal();
            
            // 模拟恢复过程
            setTimeout(() => {
                document.getElementById('loadingToast').style.display = 'none';
                
                // 显示成功提示
                document.getElementById('successText').textContent = '数据恢复成功';
                document.getElementById('successToast').style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('successToast').style.display = 'none';
                }, 2000);
                
            }, 2000);
        }

        // 搜索日志
        function searchLogs() {
            const keyword = document.getElementById('logSearch').value;
            if (keyword) {
                alert(`正在搜索包含"${keyword}"的操作日志...`);
            } else {
                alert('显示全部操作日志');
            }
        }

        // 查看全部日志
        function viewAllLogs() {
            alert('跳转到完整操作日志页面，显示近30天所有操作记录');
        }

        // 显示新增账号模态框
        function showAddAccountModal() {
            document.getElementById('addAccountModal').style.display = 'flex';
        }

        // 关闭新增账号模态框
        function closeAddAccountModal() {
            document.getElementById('addAccountModal').style.display = 'none';
            // 清空输入框
            document.getElementById('accountName').value = '';
            document.getElementById('accountPassword').value = '';
            document.getElementById('accountType').value = 'operator';
        }

        // 新增账号
        function addAccount() {
            const accountName = document.getElementById('accountName').value;
            const accountPassword = document.getElementById('accountPassword').value;
            const accountType = document.getElementById('accountType').value;
            
            if (!accountName) {
                alert('请输入账号名称');
                return;
            }
            
            if (!accountPassword) {
                alert('请设置初始密码');
                return;
            }
            
            // 显示加载提示
            document.getElementById('loadingToast').style.display = 'block';
            closeAddAccountModal();
            
            // 模拟新增过程
            setTimeout(() => {
                document.getElementById('loadingToast').style.display = 'none';
                
                // 显示成功提示
                document.getElementById('successText').textContent = `账号 ${accountName} 创建成功`;
                document.getElementById('successToast').style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('successToast').style.display = 'none';
                }, 2000);
                
            }, 1000);
        }

        // 切换账号状态
        function toggleAccountStatus(accountName, action) {
            let actionText = action === 'disable' ? '禁用' : '启用';
            
            if (confirm(`确定要${actionText}账号 ${accountName} 吗？`)) {
                // 显示成功提示
                document.getElementById('successText').textContent = `账号 ${accountName} ${actionText}成功`;
                document.getElementById('successToast').style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('successToast').style.display = 'none';
                }, 2000);
                
                // 实际项目中这里会更新UI显示
            }
        }

        // 重置密码
        function resetPassword(accountName) {
            document.getElementById('resetAccountName').textContent = accountName;
            document.getElementById('resetPasswordModal').style.display = 'flex';
        }

        // 关闭重置密码模态框
        function closeResetPasswordModal() {
            document.getElementById('resetPasswordModal').style.display = 'none';
        }

        // 确认重置密码
        function confirmResetPassword() {
            const accountName = document.getElementById('resetAccountName').textContent;
            
            // 显示加载提示
            document.getElementById('loadingToast').style.display = 'block';
            closeResetPasswordModal();
            
            // 模拟重置过程
            setTimeout(() => {
                document.getElementById('loadingToast').style.display = 'none';
                
                // 显示成功提示
                document.getElementById('successText').textContent = `账号 ${accountName} 密码重置成功`;
                document.getElementById('successToast').style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('successToast').style.display = 'none';
                }, 2000);
                
            }, 1000);
        }
    </script>
</body>
</html>